<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>同态加密之Paillier同态加密 | Hxd的博客</title><meta name="author" content="Hxd"><meta name="copyright" content="Hxd"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Paillier同态加密作者：hxd 日期：2025年3月28日   摘要随着云计算和人工智能的兴起，如何实现安全有效地利用数据，对持有大量数字资产的企业来说至关重要。同态加密，是解决云计算和分布式机器学习中数据安全问题的关键技术，也是隐私计算中，横跨安全多方计算，联邦学习和可信执行环境多个技术分支的热门研究方向。 本文对经典同态加密算法Pailier算法及其相关技术进行介绍，重点分析了Paill">
<meta property="og:type" content="article">
<meta property="og:title" content="同态加密之Paillier同态加密">
<meta property="og:url" content="https://hxd77.xyz/2025/04/03/%E5%90%8C%E6%80%81%E5%8A%A0%E5%AF%86%E4%B9%8BPaillier%E5%90%8C%E6%80%81%E5%8A%A0%E5%AF%86/index.html">
<meta property="og:site_name" content="Hxd的博客">
<meta property="og:description" content="Paillier同态加密作者：hxd 日期：2025年3月28日   摘要随着云计算和人工智能的兴起，如何实现安全有效地利用数据，对持有大量数字资产的企业来说至关重要。同态加密，是解决云计算和分布式机器学习中数据安全问题的关键技术，也是隐私计算中，横跨安全多方计算，联邦学习和可信执行环境多个技术分支的热门研究方向。 本文对经典同态加密算法Pailier算法及其相关技术进行介绍，重点分析了Paill">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxd77/BlogImage/Blog/6c90c790-e43f-46e6-8b1d-f6bf7532ff3c.jpg">
<meta property="article:published_time" content="2025-04-03T11:48:45.000Z">
<meta property="article:modified_time" content="2025-05-09T07:47:37.078Z">
<meta property="article:author" content="Hxd">
<meta property="article:tag" content="学习笔记">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/hxd77/BlogImage/Blog/6c90c790-e43f-46e6-8b1d-f6bf7532ff3c.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "同态加密之Paillier同态加密",
  "url": "https://hxd77.xyz/2025/04/03/%E5%90%8C%E6%80%81%E5%8A%A0%E5%AF%86%E4%B9%8BPaillier%E5%90%8C%E6%80%81%E5%8A%A0%E5%AF%86/",
  "image": "https://cdn.jsdelivr.net/gh/hxd77/BlogImage/Blog/6c90c790-e43f-46e6-8b1d-f6bf7532ff3c.jpg",
  "datePublished": "2025-04-03T11:48:45.000Z",
  "dateModified": "2025-05-09T07:47:37.078Z",
  "author": [
    {
      "@type": "Person",
      "name": "Hxd",
      "url": "https://hxd77.xyz"
    }
  ]
}</script><link rel="shortcut icon" href="https://github.com/hxd77/BlogImage/blob/master/Blog/d.jpg?raw=true"><link rel="canonical" href="https://hxd77.xyz/2025/04/03/%E5%90%8C%E6%80%81%E5%8A%A0%E5%AF%86%E4%B9%8BPaillier%E5%90%8C%E6%80%81%E5%8A%A0%E5%AF%86/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Hxd","link":"链接: ","source":"来源: Hxd的博客","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: '[object Object]',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '同态加密之Paillier同态加密',
  isHighlightShrink: true,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/custom.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-color: #efefef;"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://github.com/hxd77/BlogImage/blob/master/Blog/20250406173840676.png?raw=true" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fa fa-comments-o"></i><span> 分享</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/hxd77/BlogImage/Blog/6c90c790-e43f-46e6-8b1d-f6bf7532ff3c.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Hxd的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">同态加密之Paillier同态加密</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fa fa-comments-o"></i><span> 分享</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">同态加密之Paillier同态加密</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-04-03T11:48:45.000Z" title="发表于 2025-04-03 19:48:45">2025-04-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-05-09T07:47:37.078Z" title="更新于 2025-05-09 15:47:37">2025-05-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">2.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>10分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Paillier同态加密"><a href="#Paillier同态加密" class="headerlink" title="Paillier同态加密"></a>Paillier同态加密</h1><p>作者：hxd</p>
<p>日期：2025年3月28日</p>

<hr>
<h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><p>随着云计算和人工智能的兴起，如何实现安全有效地利用数据，对持有大量数字资产的企业来说至关重要。同态加密，是解决云计算和分布式机器学习中数据安全问题的关键技术，也是隐私计算中，横跨安全多方计算，联邦学习和可信执行环境多个技术分支的热门研究方向。</p>
<p>本文对经典同态加密算法Pailier算法及其相关技术进行介绍，重点分析了Paillier的实现原理和性能优化方案，同时对基于公钥的加密算法中的热门算法进行了横向对比。最后介绍了Paillier算法的一些实际应用。</p>
<p>【关键词】：同态加密，安全多方计算，联邦学习，隐私计算</p>
<h2 id="1-背景知识"><a href="#1-背景知识" class="headerlink" title="1 背景知识"></a>1 背景知识</h2><h3 id="1-1-同态加密"><a href="#1-1-同态加密" class="headerlink" title="1.1 同态加密"></a>1.1 同态加密</h3><p><strong>同态加密（Homomorphic Encryption，HE）是一种对加密数据进行处理的功能，是一种允许对密文进行计算操作并生成加密结果的加密技术。在密文上获得的计算结果被解密后与在明文上的计算结果相匹配。</strong>我的理解是可以在加密的数据上进行计算操作，并且得到的结果解密后与在原始数据上进行相同的计算操作得到的结果一致。</p>
<p>目前，同态加密可以分为三类：部分同态加密（Partially Homomorphic Encryption, PHE）也称为半同态加密、些许同态加密（Somewhat Homomorphic Encryption，SHE）和全同态加密（Fully Homomorphic Encryption, FHE）。半同态加密在数据加密后只持加法运算或乘法运算中的一种，根据其支持的运算的不同，又称为加法同态加密或乘法同态加密。半同态加密由于机制相对简单，相对于全同态加密技术，拥有着更好的性能。全同态加密对加密后的数据支持任意次数的加法和乘法运算。Paillier同态加密是一种半同态加密算法，仅支持加法同态。</p>
<h3 id="1-2-复合剩余类问题"><a href="#1-2-复合剩余类问题" class="headerlink" title="1.2 复合剩余类问题"></a>1.2 复合剩余类问题</h3><p>如果存在一个数</p>
<script type="math/tex; mode=display">
y\in \mathbb{Z}_{n^2}^*</script><h3 id="1-3-二项式定理"><a href="#1-3-二项式定理" class="headerlink" title="1.3 二项式定理"></a>1.3 二项式定理</h3><p>二项式定理：$n\in \mathbb{N}^*$</p>
<script type="math/tex; mode=display">
(a+b)^n=\sum_{r=0}^{n} C^r_{n} a^{n-r}b^r=C^0_{n} a^{n}+C^1_{n} a^{n-1}b+\cdots C^r_{n} a^{n-r}b^r+C^n_{n} b^n</script><p>当$a=1,b=n,n=x$时可以化成下面的形式：</p>
<script type="math/tex; mode=display">
(1+n)^x=1+nx+\frac{x(x-1)n^2}{2!}+\cdots</script><p>可以化为</p>
<script type="math/tex; mode=display">
(1+n)^x\equiv 1+nx(\mod n^2)</script><p>令$y=(1+n)^x \mod n^2 $，可化简为$x\equiv \frac{y-1}{n} (\mod n^2)$，再令$L(u)=\frac{u-1}n$</p>
<p>则</p>
<script type="math/tex; mode=display">
\begin{equation}
L\left((1+n)^{x} \bmod n^{2}\right) \equiv L(y) \equiv \frac{y-1}{n} \quad(\bmod n) \equiv x \quad(\bmod n) 
\end{equation}</script><p>即 $L\left((1+n)^{x}  \mod n^{2}\right) \equiv x \quad(\bmod n)$</p>
<h2 id="2-Paillier算法"><a href="#2-Paillier算法" class="headerlink" title="2 Paillier算法"></a>2 Paillier算法</h2><h3 id="2-1-密钥生成"><a href="#2-1-密钥生成" class="headerlink" title="2.1 密钥生成"></a>2.1 密钥生成</h3><p>类似于RSA算法，Paillier也拥有公钥和私钥对。</p>
<ol>
<li><p>随机选择两个大素数$p,q$且$p\ne q$，满足$gcd(pq,(p-1)(q-1))=1$，且满足$p,q$的长度相等。</p>
</li>
<li><p>计算$n=pq$以及$\lambda=lcm(p-1,q-1)$，这里$lcm$表示最小公倍数</p>
</li>
<li><p>随机选择$g\leftarrow \mathbb{Z}_{n^2}^*$</p>
</li>
<li><p>定义$L$函数：$L(x)=\frac{x-1}{n}$，计算$\mu=(L(g^\lambda \mod n^2))^{-1} \mod n$</p>
<p>公钥：$(n,g)$，私钥：$(\lambda,\mu)$</p>
</li>
</ol>
<p>例如：</p>
<ul>
<li><p>Alice选择两个大素数$p=11,q=19$</p>
</li>
<li><p>Alice计算$n=p*q=209$，并计算$\lambda=lcm(p-1,q-1)=(10,18)=90$</p>
</li>
<li><p>Alice选择一个随机整数$g=147\in \mathbb{Z}_{n^2}^*$</p>
</li>
<li><p>Alice定义函数$L(x)=\frac{x-1}{n}$，计算$\mu=(L(g^\lambda \mod n^2))^{-1} \mod n =153$</p>
</li>
</ul>
<p>所以现在Alice一共生成了6个数字：</p>
<script type="math/tex; mode=display">
p=11,q=19,n=209,\lambda=90,g=147,\mu=153</script><p>公钥为$(n,g)=(209,147)$，私钥为$(\lambda,\mu)=(90,153)$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p=<span class="number">11</span>;q=<span class="number">19</span>;n=<span class="number">209</span>;lambda1=<span class="number">90</span>;g=<span class="number">147</span></span><br><span class="line">L=<span class="keyword">lambda</span> x:(x-<span class="number">1</span>)/n</span><br><span class="line">mu=gmpy2.powmod(<span class="built_in">int</span>(L(gmpy2.mod(<span class="built_in">pow</span>(g,lambda1),<span class="built_in">pow</span>(n,<span class="number">2</span>)))),-<span class="number">1</span>,n)</span><br><span class="line"><span class="built_in">print</span>(mu)</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/hxd77/BlogImage/master/BlogNotCDN/image-20250509154620547.png" alt="image-20250509154620547"></p>
<h3 id="2-3-2-加密"><a href="#2-3-2-加密" class="headerlink" title="2.3.2 加密"></a>2.3.2 加密</h3><ol>
<li><p>输入明文消息$m$，满足$0\le m\le n$</p>
</li>
<li><p>选择随机数$r$满足$0\le r\le n$且$r\in \mathbb{Z}_{n}^*$</p>
</li>
<li><p>计算密文$c=g^mr^n \mod n^2$</p>
</li>
</ol>
<p>例如：</p>
<ul>
<li>假设Bob需要加密明文$m=8$，且Bob收到了Alice发送来的公钥$(n,g)$</li>
<li>Bob选择随机数$r=3$</li>
<li>Bob计算密文$c=32948$</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c=gmpy2.mod(<span class="built_in">pow</span>(g,m)*<span class="built_in">pow</span>(r,n),<span class="built_in">pow</span>(n,<span class="number">2</span>))</span><br></pre></td></tr></table></figure>
<h3 id="2-2-解密"><a href="#2-2-解密" class="headerlink" title="2.2 解密"></a>2.2 解密</h3><ol>
<li><p>输入密文$c$，满足$c\in \mathbb{Z}_{n^2}^*$</p>
</li>
<li><p>计算明文消息$m=L(c^\lambda \mod n^2))\cdot\mu \mod n$</p>
</li>
</ol>
<p>例如：</p>
<ul>
<li><p>Bob发送密文$c$，且$c\in \mathbb{Z}_{n^2}^*$</p>
</li>
<li><p>Alice计算明文$m=L(c^\lambda \mod n^2))\cdot\mu \mod n=8$</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">m1=gmpy2.mod(L(gmpy2.mod(<span class="built_in">pow</span>(c,lambda1),<span class="built_in">pow</span>(n,<span class="number">2</span>)))*mu,n)</span><br></pre></td></tr></table></figure>
<h3 id="2-3-正确性证明"><a href="#2-3-正确性证明" class="headerlink" title="2.3 正确性证明"></a>2.3 正确性证明</h3><p>这里可以将$g$进行优化成$g=n-1,\lambda=\varphi(n)=(p-1)(q-1),\mu=\varphi(n)^{-1}\bmod n$</p>
<p>证明如下:</p>
<script type="math/tex; mode=display">
\begin{equation}
Dec(c)=m=L(c^\lambda \bmod n^2))\cdot\mu \bmod n=L((g^mr^n\bmod n^2)^\lambda \bmod n^2))\cdot \mu=L(g^{\lambda m}r^{\lambda n} \bmod n^2))\cdot \mu \bmod n\\
\end{equation}</script><p>根据卡米切尔定理（Carmichael’s function）有：</p>
<script type="math/tex; mode=display">
r^{\lambda n}\equiv 1\mod n^2</script><p>所以继续化简，且由$L\left((1+n)^{x}  \mod n^{2}\right) \equiv x \quad(\bmod n)$知，</p>
<script type="math/tex; mode=display">
Dec(c)=L(g^{\lambda m}\mod n^2))\cdot \mu \mod n=\lambda m\cdot \mu \bmod n=\lambda m\cdot \frac{1}{\mu}\bmod n=m</script><blockquote>
<p><strong>Carmichael number</strong>的定义是，对于一个合数 $n$ ，如果所有与 $n$ 互质的正整数 $b$ ，都有 $b^{n-1} \equiv 1\left(\bmod n^{2}\right)$ 成立，则 $n$ 称为Carmichael number。其中 $0&lt;b&lt;n$<br>$r^{\lambda n} \bmod n^{2}=1$ 其实是<strong>Carmichael＇s theorem</strong>的一个推论，这里不再详细说明。<br>对两个数的乘积求余，与对这两个数先求余再相乘的结果相同</p>
</blockquote>
<h3 id="2-5-Paillier同态加密性质"><a href="#2-5-Paillier同态加密性质" class="headerlink" title="2.5 Paillier同态加密性质"></a>2.5 Paillier同态加密性质</h3><h3 id="2-5-1-加法"><a href="#2-5-1-加法" class="headerlink" title="2.5.1 加法"></a>2.5.1 加法</h3><script type="math/tex; mode=display">
\begin{equation*}Dec(c_1  \cdot c_2 \bmod n^{2})=Dec\left(Enc\left(m_{1}, r_{1}\right) \cdot Enc\left(m_{2}, r_{2}\right) \bmod n^{2}\right)=m_{1}+m_{2} \bmod n \end{equation*}</script><p>这个公式的意思是，明文 $m_{1}$ 和 $m_{2}$ ，随机选择的加密因子随机数 $r_{1}$ 和 $r_{2}$ 。 $m_{1}$ 和 $m_{2}$ 加密后相乘再解密的结果，与 $m_{1}+m_{2}$ 对 $n$ 求余的结果相同。</p>
<h3 id="2-5-2-乘法"><a href="#2-5-2-乘法" class="headerlink" title="2.5.2 乘法"></a>2.5.2 乘法</h3><script type="math/tex; mode=display">
\begin{align*}
& Dec\left(Enc\left(m_{1}, r_{1}\right)^{m_{2}} \bmod n^{2}\right)=m_{1} m_{2} \bmod n  \\
& Dec\left(Enc\left(m_{2}, r_{2}\right)^{m_{1}} \bmod n^{2}\right)=m_{1} m_{2} \bmod n 
\end{align*}</script><p>但是据我了解Paillier同态加密是不支持乘法同态的，仅支持密文乘标量，而不支持密文乘密文。一般地</p>
<script type="math/tex; mode=display">
\begin{equation*}
Dec\left(Enc\left(m_{1}, r_{1}\right)^{k} \bmod n^{2}\right)=k m_{1} \bmod n \end{equation*}</script><h3 id="2-5-3-证明"><a href="#2-5-3-证明" class="headerlink" title="2.5.3 证明"></a>2.5.3 证明</h3><h4 id="加法证明"><a href="#加法证明" class="headerlink" title="加法证明:"></a>加法证明:</h4><script type="math/tex; mode=display">
\begin{gather*}
Enc\left(m_{1}, r_{1}\right)=c_{1}=g^{m 1} \cdot r_{1}^{n} \bmod n^{2}  \\
Enc\left(m_{2}, r_{2}\right)=c_{2}=g^{m 2} \cdot r_{2}^{n} \bmod n^{2}  \\
c_{1} \cdot c_{2}=g^{m_1+m_2} \cdot\left(r_{1} \cdot r_{2}\right)^{n} \bmod n^{2}  \\
Dec\left(c_{1} \cdot c_{2}\right) \equiv L\left(g^{\lambda\left(m_{1}+m_{2}\right)} \cdot\left(r_{1} \cdot r_{2}\right)^{\lambda n} \bmod n^{2}\right) \cdot \mu \bmod n  \\
\equiv \lambda\left(m_{1}+m_{2}\right) \cdot \mu \quad(\bmod n) \\
\equiv m_{1}+m_{2} \quad(\bmod n)
\end{gather*}</script><p>其中 $\left(r_{1} \cdot r_{2}\right)^{\lambda n} \equiv 1\left(\bmod n^{2}\right)$ ，依然是利用Carmichael＇s theorem。也不要忘了 $\mu=\lambda^{-1}$ 。加法证毕。</p>
<h4 id="乘法证明"><a href="#乘法证明" class="headerlink" title="乘法证明:"></a>乘法证明:</h4><script type="math/tex; mode=display">
\begin{gather*}
& Enc\left(m_{1}, r_{1}\right)^{m_{2}} \bmod n^{2}=c_{1}^{m_2}=(g^{m_1} \cdot r_{1}^{n})^{m_2} \bmod n^{2}  \\
&  Dec\left(Enc\left(m_{1}, r_{1}\right)^{m_{2}} \bmod n^{2}\right)=Dec\left(c_{1}^{m_2}\right)=L(g^{\lambda m_1} \cdot r_{1}^{\lambda n})^{m_2} \bmod n^{2}=L(g^{\lambda m_1 m_2} \cdot r_{1}^{\lambda n m2})\cdot \mu \bmod n^{2}=\lambda(m_1m_2)\cdot \mu=m_1m_2\\
& Enc\left(m_{2}, r_{2}\right)^{m_{1}} \bmod n^{2}=c_{2}^{m1}=(g^{m 2} \cdot r_{1}^{n})^{m1} \bmod n^{2}\\

& Dec\left(Enc\left(m_{2}, r_{2}\right)^{m_{1}} \bmod n^{2}\right)=Dec\left(c_{2}^{m_1}\right)=L(g^{\lambda m_2} \cdot r_{2}^{\lambda n})^{m_1} \bmod n^{2}=L(g^{\lambda m_1 m_2} \cdot r_{1}^{\lambda n m2})\cdot \mu \bmod n^{2}=\lambda(m_1m_2)\cdot \mu=m_1m_2
\end{gather*}</script><h3 id="2-6-Paillier实战"><a href="#2-6-Paillier实战" class="headerlink" title="2.6 Paillier实战"></a>2.6 Paillier实战</h3><p>这里主要是使用python-paillier开源库进行模拟, 地址: <a target="_blank" rel="noopener" href="https://github.com/data61/python-paillier">python-paillier</a></p>
<h4 id="2-6-1-安装python-paillier库"><a href="#2-6-1-安装python-paillier库" class="headerlink" title="2.6.1 安装python-paillier库"></a>2.6.1 安装python-paillier库</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip install phe</span><br></pre></td></tr></table></figure>
<h4 id="2-6-2-基本用法"><a href="#2-6-2-基本用法" class="headerlink" title="2.6.2 基本用法"></a>2.6.2 基本用法</h4><p>测试代码如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> phe <span class="keyword">import</span>  paillier</span><br><span class="line"><span class="keyword">from</span> phe.command_line <span class="keyword">import</span> encrypt</span><br><span class="line"></span><br><span class="line"><span class="comment">#生成私钥和公钥</span></span><br><span class="line">public_key,private_key=paillier.generate_paillier_keypair()</span><br><span class="line"></span><br><span class="line">secret_number_list=[<span class="number">3.141592653</span>,<span class="number">50000</span>,-<span class="number">4.6e-12</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#加密</span></span><br><span class="line">encrypted=[public_key.encrypt(x) <span class="keyword">for</span> x <span class="keyword">in</span> secret_number_list]</span><br><span class="line">a,b,c=encrypted <span class="comment">#a,b,c为分别对应的密文</span></span><br><span class="line"><span class="comment">#解密</span></span><br><span class="line">decrypted=[private_key.decrypt(x) <span class="keyword">for</span> x <span class="keyword">in</span> encrypted]</span><br><span class="line"><span class="comment">#print(decrypted)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;原始的明文数据是:&quot;</span>,secret_number_list)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;加密后的密文为:\n<span class="subst">&#123;a.ciphertext()&#125;</span>\n<span class="subst">&#123;b.ciphertext()&#125;</span>\n<span class="subst">&#123;c.ciphertext()&#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#直接在密文上进行操作</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;直接在密文上进行加法+2操作:&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> encrypted:</span><br><span class="line">    <span class="built_in">print</span>(private_key.decrypt(x+<span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;直接在密文上进行乘法*2操作:&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> encrypted:</span><br><span class="line">    <span class="built_in">print</span>(private_key.decrypt(x*<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#测试加法同态和乘法同态</span></span><br><span class="line"><span class="comment">#同态加密就是直接在密文上进行计算操作，且得到的结果解密后与原始数据进行相同计算操作得到的结果一致</span></span><br><span class="line"><span class="keyword">if</span>(private_key.decrypt(a+b)==secret_number_list[<span class="number">0</span>]+secret_number_list[<span class="number">1</span>]):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;加法同态得到结果一致&quot;</span>)</span><br><span class="line"><span class="comment">#不支持密文*密文操作</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">原始的明文数据是: [<span class="number">3.141592653</span>, <span class="number">50000</span>, -<span class="number">4.6e-12</span>]</span><br><span class="line">加密后的密文为:</span><br><span class="line"><span class="number">6135642717476440288407940386973406424179597264131770247248102742010468720333833225649509063748135593417249291664647230118171880275385427768661278194179811149980484107875079167966037640330927833409551348424009960068423059960154838566322299195353397421437872915804745060533261832278429271204744456789961203266052848010919722959341417482024982142102529926890593903314112664543957037887158716744571871264210589446764218013112820393615950957086607861565308016365237196306966010745077365412367839307532518170100179456773127734147346604235844813044265233075016539928080838485143223995802554571383461035263995403783064611306317555256285988840969029742977968144872682458936420127227230476819291303124001473587923460769397658268024400886555390258660618373303414439455211672717812666697638035222117443908650283514435608463625378214050364068755129824410490701664831571275306964067204071005470027118378689651829148880539573822487153481061470277580577600175521806242106858972388994227724395869506642559032895967293793343876890145360440625385914915118257143910111826237187307820978010483113189911368282892421162883412638039297069837343163912708762909713756179690176457109522301379897744926757752311597922050024148761665375103555182414838633525445609661410252899063498510115771914132805409567484187921658398974418382890964839125981586348726045243333495314428481282190467375523460497432128692207506441289627508380795234964885871582085230280132691345948398132555966200855244255648321920131951439696611676124269404466976180294962281445458807943012918012404089846508333274591599727485060331623606174040694791503822698059396853307777347504952896153744082791225468534691438132909249689191233089350038971418419335809120903150499784609969567112545363360198125593245665624566815113695011787411604336491361460042949730556105104860435984770859626375877623884062067189129950180</span></span><br><span class="line"><span class="number">887005022522579447848205920806710360909905718591189281931160414910549152523241076199319838555395628981196313249650442055291336440727334264609927402686839092259539091806267508731596185601945267340158283814725867055142350838873977884437455988256793834938544399110653821598343100566315517131009630463758427674741632987854143941273277406130544928639596805847903901872619306943467440651124331358414655009038819086417786999141500468891038595923333543228285676618955025241632566941244513073724178810891249994862641467055938701921034463570669407425499466966614995736403620307164619068695077483394674655491668059501289997984748471727455510282488950427021066786988802714724934069315750072430493670702292961959351861990350908010035027235436142496519572061639045766037724040168016634665220315171534601878486078146141036209112753667794836310776413372090360499415335386249693576221646721388111593525013348622038294276700011838623658512860535722955926153513295870279541110526588704213026487898973565504365143192106523282754721704597946528197131102310494268027064892280655944273426061769686315420030387006946764328759186228215890918819632830165788070069840471094460082378686670731840685542630431810339310104136600202543862750484297465773842549039973676782156504118923176398442761632823191417959286488765026652099790923996485356416436227426568760028842792661257638755706242281259745653462582679989619677046541678862053832610084198972899069941746702241883580322136635072016411615020395158346898642764436395616200752755431700573294891784344134726676362530310448752821280044944859856437724872997808669615929491594710408026028211363505886848089977144357763600878248532335971494244646237482683583560221949882212204132473662202602957427603105175985896686514125329220361852710593844658262087288692429013917912788736677741102128337897654661912656981245063891143413271880198</span></span><br><span class="line"><span class="number">4037834938559113619998421172126988631404057769776394076009642746492930549963427577763531697013121860978579303640942002203573909988758058637783285612984589563341275746505104066786459644139296154989247555286766332632956277526381221905394405047878853819672351319589245550064992212014659527107405496539715766902603145770139269460891688467495430592590109629243358486012139563568091165337492106001695221963062782387101039883902482021844332025477744754094691117955989515071972713229143707017639271181111758343051392150486122301639851781824768663450374570863934194319372897693598980087567991904726792217639572484515329384708058640520702920356676765045039269097405323207102964402256931020225226574796100098393728445500536230857645017388597635343797974623015219437794113364384121571373446465230310133314591493338351772191359455173800995719951869852495461808153822475333168253753478440159263287430264597640183391855918546893101611046809590097041491211129504239765147502244593473087877341414822274679881047552475492207704048970711469190320750078378942213065783986762161609262844273973580105444131146141091913501127480420309827038824652233093197954777717602547166876425118434350400560848462197198332051713282037170254544403656446710150866640615337026352654671865687758120421675024795483426165854979402460251083766743824236705890427680912489990719801474531552377098780868655341869341506050884129178193807619968296450530661258034692933951102120282490300045565528259615887430240284882048366613762768924291240487713709102291659985373901417584488360396271364473451620447795773907199476071956478187939530636081184148667494643604921345971538250781793067325928447552265330527703761935250265847640143558212289976423426290977866451255574548301724673646029516803256160958927650871855915629377334996810457919664025499656727666953298009410893931657899407241861948032341341509</span></span><br><span class="line"></span><br><span class="line">直接在密文上进行加法+<span class="number">2</span>操作:</span><br><span class="line"><span class="number">5.141592653</span></span><br><span class="line"><span class="number">50002</span></span><br><span class="line"><span class="number">1.9999999999954</span></span><br><span class="line">直接在密文上进行乘法*<span class="number">2</span>操作:</span><br><span class="line"><span class="number">6.283185306</span></span><br><span class="line"><span class="number">100000</span></span><br><span class="line">-<span class="number">9.2e-12</span></span><br><span class="line">加法同态得到结果一致</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://hxd77.xyz">Hxd</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://hxd77.xyz/2025/04/03/%E5%90%8C%E6%80%81%E5%8A%A0%E5%AF%86%E4%B9%8BPaillier%E5%90%8C%E6%80%81%E5%8A%A0%E5%AF%86/">https://hxd77.xyz/2025/04/03/同态加密之Paillier同态加密/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://hxd77.xyz" target="_blank">Hxd的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a></div><div class="post-share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/hxd77/BlogImage/Blog/6c90c790-e43f-46e6-8b1d-f6bf7532ff3c.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/04/05/%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81%E5%AD%A6%E7%9A%84%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%801/" title="公钥密码学的数学基础1"><img class="cover" src="https://cdn.jsdelivr.net/gh/hxd77/BlogImage/Blog/1083b3b738d9f0168d23d676d4c9eb42.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">公钥密码学的数学基础1</div></div><div class="info-2"><div class="info-item-1">公钥密码学有关知识作者：hxd 日期：2025年3月28日  欧拉函数的知识欧拉函数（Euler’s Totient Function），记作$\phi(n)$，是数论中的一个重要函数，表示小于或等于正整数$n$且与$n$互质的正整数的个数。这里“互质”指的是最大公约数为1。 欧拉函数的定义对于正整数$n$，欧拉函数$\phi(n)$定义为： $\phi(n) = \text{小于或等于 } n \text{ 且与 } n \text{ 互质的正整数的个数}$ 欧拉函数的性质 对于素数$p$：  \phi(p) = p - 1因为素数与所有小于它的正整数都互质。  对于素数的幂$p^k$：    \phi(p^k) = p^k - p^{k-1}   这是因为在$1$到$p^k$之间，只有$p$的倍数（共有$p^{k-1}$个）不与$p^k$互质。  积性函数：如果两个正整数$a$和$b$互质（即$\gcd(a, b) = 1$），则：  \phi(ab) = \phi(a) \cdot \phi(b) 一般公式：如果$n$的质因数分解为：  n = p_1^{k_1} p_2^...</div></div></div></a><a class="pagination-related" href="/2025/04/03/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/" title="我的第一篇博客"><img class="cover" src="https://cdn.jsdelivr.net/gh/hxd77/BlogImage/Blog/Aespa%20%23karina.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">我的第一篇博客</div></div><div class="info-2"><div class="info-item-1">搞博客主要是每次搜集资料非常麻烦，所以我就想着自己搭建一个博客然后来记录一些知识点，同时我也会在我的博客上分享我的日常和生活。 </div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/04/05/Diffie-Hellman%E5%AF%86%E9%92%A5%E4%BA%A4%E6%8D%A2%E5%8D%8F%E8%AE%AE/" title="Diffie-Hellman密钥交换协议"><img class="cover" src="https://cdn.jsdelivr.net/gh/hxd77/BlogImage/Blog/bec35d35-0691-491e-a980-87b87aeab555.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-05</div><div class="info-item-2">Diffie-Hellman密钥交换协议</div></div><div class="info-2"><div class="info-item-1">Diffile-Hellman密钥交换协议作者: hxd  日期: 2025年3月28日Diffie-Hellman（迪菲-赫尔曼）是一种密钥交换协议，由 Whitfield Diffie 和 Martin Hellman 在 1976 年提出。它是现代密码学中最重要的协议之一，用于在不安全的通信渠道上安全地交换密钥。Diffie-Hellman 协议的核心思想是允许双方通过公开的通信渠道生成一个共享的密钥，而无需事先共享任何秘密信息。 Diffie-Hellman 的核心概念 密钥交换的目标： 通信双方（例如 Alice 和 Bob）希望生成一个共享的密钥，用于后续的加密通信（如对称加密）。 这个密钥需要在公开的通信渠道上生成，即使攻击者监听了通信内容，也无法推导出共享密钥。   数学基础： Diffie-Hellman 基于离散对数问题的数学难题。 它使用模幂运算和大素数的性质来确保安全性。   协议流程： 双方协商两个公开的参数：一个大素数$p$和一个生成元$g$（$g$是模$p$的一个原根）。 双方各自选择一个私密的随机数（$a$和$b$），并计算自己的公钥： Alice...</div></div></div></a><a class="pagination-related" href="/2025/04/05/Shamir%E7%A7%98%E5%AF%86%E5%85%B1%E4%BA%AB/" title="Shamir秘密共享"><img class="cover" src="https://cdn.jsdelivr.net/gh/hxd77/BlogImage/Blog/4dbbcaf2-5b03-4691-aa55-5c9ecbe3a981.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-05</div><div class="info-item-2">Shamir秘密共享</div></div><div class="info-2"><div class="info-item-1">Shamir秘密共享作者：hxd 日期：2025年3月28日  1. 秘密共享秘密 $s$ （通过某种方案）被分为 $n$ 个部分,每个部分称为份额(share),由一个参与者持有，使得  由 $k$ 个或多于 $k$ 个参与者所持有的部分信息可重构 $s$  由少于 $k$ 个参与者所持有的部分信息则无法重构 $s$  称该方案为 $(k,n)$ 门限秘密共享方案，$k$ 称为门限值。 2. Shamir秘密共享（Shamir Secret Sharing SSS）Shamir秘密共享（Shamir’s Secret Sharing, SSS） 是一种密码学协议，由 Adi Shamir 在 1979 年提出。它的核心思想是将一个秘密（如密钥或敏感数据）分成多个部分（称为“份额”或“shares”），并将这些份额分发给多个参与者。只有达到一定数量的份额（称为“阈(yu)值”）才能恢复出原始秘密，而少于阈值的份额无法提供任何关于秘密的信息。 SSS 是一种门限秘密共享方案，广泛应用于分布式系统、密码学、数据备份和安全多方计算等领域。 前言 多项式上的 $k$ 个点能够唯一确定小于...</div></div></div></a><a class="pagination-related" href="/2025/04/05/%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81%E5%AD%A6%E7%9A%84%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%801/" title="公钥密码学的数学基础1"><img class="cover" src="https://cdn.jsdelivr.net/gh/hxd77/BlogImage/Blog/1083b3b738d9f0168d23d676d4c9eb42.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-05</div><div class="info-item-2">公钥密码学的数学基础1</div></div><div class="info-2"><div class="info-item-1">公钥密码学有关知识作者：hxd 日期：2025年3月28日  欧拉函数的知识欧拉函数（Euler’s Totient Function），记作$\phi(n)$，是数论中的一个重要函数，表示小于或等于正整数$n$且与$n$互质的正整数的个数。这里“互质”指的是最大公约数为1。 欧拉函数的定义对于正整数$n$，欧拉函数$\phi(n)$定义为： $\phi(n) = \text{小于或等于 } n \text{ 且与 } n \text{ 互质的正整数的个数}$ 欧拉函数的性质 对于素数$p$：  \phi(p) = p - 1因为素数与所有小于它的正整数都互质。  对于素数的幂$p^k$：    \phi(p^k) = p^k - p^{k-1}   这是因为在$1$到$p^k$之间，只有$p$的倍数（共有$p^{k-1}$个）不与$p^k$互质。  积性函数：如果两个正整数$a$和$b$互质（即$\gcd(a, b) = 1$），则：  \phi(ab) = \phi(a) \cdot \phi(b) 一般公式：如果$n$的质因数分解为：  n = p_1^{k_1} p_2^...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://github.com/hxd77/BlogImage/blob/master/Blog/20250406173840676.png?raw=true" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Hxd</div><div class="author-info-description">东隅已逝,桑榆非晚</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/hxd77"><i></i><span>😘关注我...</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/hxd77" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://blog.csdn.net/m0_74005941?spm=1018.2226.3001.5343" target="_blank" title="CSDN"><i class="fa fa-book-open"></i></a><a class="social-icon" href="mailto:hxddong77@163.com" target="_blank" title="Email"><i class="fas fa-envelope-open-text"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">独行侠总冠军！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Paillier%E5%90%8C%E6%80%81%E5%8A%A0%E5%AF%86"><span class="toc-number">1.</span> <span class="toc-text">Paillier同态加密</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%91%98%E8%A6%81"><span class="toc-number">1.1.</span> <span class="toc-text">摘要</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86"><span class="toc-number">1.2.</span> <span class="toc-text">1 背景知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%90%8C%E6%80%81%E5%8A%A0%E5%AF%86"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.1 同态加密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E5%A4%8D%E5%90%88%E5%89%A9%E4%BD%99%E7%B1%BB%E9%97%AE%E9%A2%98"><span class="toc-number">1.2.2.</span> <span class="toc-text">1.2 复合剩余类问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E4%BA%8C%E9%A1%B9%E5%BC%8F%E5%AE%9A%E7%90%86"><span class="toc-number">1.2.3.</span> <span class="toc-text">1.3 二项式定理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Paillier%E7%AE%97%E6%B3%95"><span class="toc-number">1.3.</span> <span class="toc-text">2 Paillier算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90"><span class="toc-number">1.3.1.</span> <span class="toc-text">2.1 密钥生成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-2-%E5%8A%A0%E5%AF%86"><span class="toc-number">1.3.2.</span> <span class="toc-text">2.3.2 加密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E8%A7%A3%E5%AF%86"><span class="toc-number">1.3.3.</span> <span class="toc-text">2.2 解密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E6%AD%A3%E7%A1%AE%E6%80%A7%E8%AF%81%E6%98%8E"><span class="toc-number">1.3.4.</span> <span class="toc-text">2.3 正确性证明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-Paillier%E5%90%8C%E6%80%81%E5%8A%A0%E5%AF%86%E6%80%A7%E8%B4%A8"><span class="toc-number">1.3.5.</span> <span class="toc-text">2.5 Paillier同态加密性质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-1-%E5%8A%A0%E6%B3%95"><span class="toc-number">1.3.6.</span> <span class="toc-text">2.5.1 加法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-2-%E4%B9%98%E6%B3%95"><span class="toc-number">1.3.7.</span> <span class="toc-text">2.5.2 乘法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-3-%E8%AF%81%E6%98%8E"><span class="toc-number">1.3.8.</span> <span class="toc-text">2.5.3 证明</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E6%B3%95%E8%AF%81%E6%98%8E"><span class="toc-number">1.3.8.1.</span> <span class="toc-text">加法证明:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B9%98%E6%B3%95%E8%AF%81%E6%98%8E"><span class="toc-number">1.3.8.2.</span> <span class="toc-text">乘法证明:</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-Paillier%E5%AE%9E%E6%88%98"><span class="toc-number">1.3.9.</span> <span class="toc-text">2.6 Paillier实战</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-1-%E5%AE%89%E8%A3%85python-paillier%E5%BA%93"><span class="toc-number">1.3.9.1.</span> <span class="toc-text">2.6.1 安装python-paillier库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-2-%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="toc-number">1.3.9.2.</span> <span class="toc-text">2.6.2 基本用法</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/08/08/HTML-Day2/" title="HTML_Day2"><img src="https://cdn.jsdelivr.net/gh/hxd77/BlogImage/Blog/20250808114048423.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HTML_Day2"/></a><div class="content"><a class="title" href="/2025/08/08/HTML-Day2/" title="HTML_Day2">HTML_Day2</a><time datetime="2025-08-08T03:42:13.000Z" title="发表于 2025-08-08 11:42:13">2025-08-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/23/HTML_Day1/" title="HTML_Day1"><img src="https://cdn.jsdelivr.net/gh/hxd77/BlogImage/Blog/20250722215321155.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HTML_Day1"/></a><div class="content"><a class="title" href="/2025/07/23/HTML_Day1/" title="HTML_Day1">HTML_Day1</a><time datetime="2025-07-22T17:35:16.000Z" title="发表于 2025-07-23 01:35:16">2025-07-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/03/Exploit-Excercise-Nebula-7/" title="Exploit-Excercise-Nebula-7"><img src="https://cdn.jsdelivr.net/gh/hxd77/BlogImage/Blog/20250605174622684.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Exploit-Excercise-Nebula-7"/></a><div class="content"><a class="title" href="/2025/06/03/Exploit-Excercise-Nebula-7/" title="Exploit-Excercise-Nebula-7">Exploit-Excercise-Nebula-7</a><time datetime="2025-06-03T14:38:16.000Z" title="发表于 2025-06-03 22:38:16">2025-06-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/03/Exploit-Excercise-Nebula-6/" title="Exploit-Excercise-Nebula-6"><img src="https://cdn.jsdelivr.net/gh/hxd77/BlogImage/Blog/20250603223527013.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Exploit-Excercise-Nebula-6"/></a><div class="content"><a class="title" href="/2025/06/03/Exploit-Excercise-Nebula-6/" title="Exploit-Excercise-Nebula-6">Exploit-Excercise-Nebula-6</a><time datetime="2025-06-03T14:38:10.000Z" title="发表于 2025-06-03 22:38:10">2025-06-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/03/Exploit-Excercise-Nebula-5/" title="Exploit-Excercise-Nebula-5"><img src="https://cdn.jsdelivr.net/gh/hxd77/BlogImage/Blog/20250603223549816.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Exploit-Excercise-Nebula-5"/></a><div class="content"><a class="title" href="/2025/06/03/Exploit-Excercise-Nebula-5/" title="Exploit-Excercise-Nebula-5">Exploit-Excercise-Nebula-5</a><time datetime="2025-06-03T14:34:46.000Z" title="发表于 2025-06-03 22:34:46">2025-06-03</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://cdn.jsdelivr.net/gh/hxd77/BlogImage/Blog/6c90c790-e43f-46e6-8b1d-f6bf7532ff3c.jpg);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By Hxd</span></div><div class="footer_custom_text">I wish you to become your own sun, no need to rely on who's light.<p><a target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo"></a>&nbsp;<a target="_blank" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用butterfly"></a>&nbsp;<a target="_blank" href="https://www.jsdelivr.com/"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用JsDelivr为静态资源提供CDN加速"></a> &nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Vervel-brightgreen?style=flat&logo=Vercel" title="本站采用双线部署，默认线路托管于Vercel"></a>&nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Coding-0cedbe?style=flat&logo=Codio" title="本站采用双线部署，联通线路托管于Coding"></a>&nbsp;<a target="_blank" href="https://github.com/"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由Gtihub托管"></a>&nbsp;<a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://my-twikoo-cbb3.vercel.app/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://my-twikoo-cbb3.vercel.app/',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script src="xxxx"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="true" data-text="I,LOVE,YOU" data-fontsize="15px" data-random="true" async="async"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      const usePjax = true
      true
        ? (usePjax ? pjax.loadUrl('/404.html') : window.location.href = '/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>